{"ast":null,"code":"function _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n    return arr2;\n  }\n}\nimport { matchesCSSRules } from './../helpers/dom/element';\nimport { isEmpty } from './../helpers/mixed';\nvar ESCAPED_HTML_CHARS = {\n  '&nbsp;': '\\x20',\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>'\n};\nvar regEscapedChars = new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(function (key) {\n  return \"(\".concat(key, \")\");\n}).join('|'), 'gi');\n/**\n * Verifies if node is an HTMLTable element.\n *\n * @param {Node} element Node to verify if it's an HTMLTable.\n * @returns {Boolean}\n */\n\nfunction isHTMLTable(element) {\n  return (element && element.nodeName || '') === 'TABLE';\n}\n/**\n * Converts Handsontable into HTMLTableElement.\n *\n * @param {Core} instance\n * @returns {String} outerHTML of the HTMLTableElement\n */\n\nexport function instanceToHTML(instance) {\n  var hasColumnHeaders = instance.hasColHeaders();\n  var hasRowHeaders = instance.hasRowHeaders();\n  var coords = [hasColumnHeaders ? -1 : 0, hasRowHeaders ? -1 : 0, instance.countRows() - 1, instance.countCols() - 1];\n  var data = instance.getData.apply(instance, coords);\n  var countRows = data.length;\n  var countCols = countRows > 0 ? data[0].length : 0;\n  var TABLE = ['<table>', '</table>'];\n  var THEAD = hasColumnHeaders ? ['<thead>', '</thead>'] : [];\n  var TBODY = ['<tbody>', '</tbody>'];\n  var rowModifier = hasRowHeaders ? 1 : 0;\n  var columnModifier = hasColumnHeaders ? 1 : 0;\n  for (var row = 0; row < countRows; row += 1) {\n    var isColumnHeadersRow = hasColumnHeaders && row === 0;\n    var CELLS = [];\n    for (var column = 0; column < countCols; column += 1) {\n      var isRowHeadersColumn = !isColumnHeadersRow && hasRowHeaders && column === 0;\n      var cell = '';\n      if (isColumnHeadersRow) {\n        cell = \"<th>\".concat(instance.getColHeader(column - rowModifier), \"</th>\");\n      } else if (isRowHeadersColumn) {\n        cell = \"<th>\".concat(instance.getRowHeader(row - columnModifier), \"</th>\");\n      } else {\n        var cellData = data[row][column];\n        var _instance$getCellMeta = instance.getCellMeta(row - rowModifier, column - columnModifier),\n          hidden = _instance$getCellMeta.hidden,\n          rowspan = _instance$getCellMeta.rowspan,\n          colspan = _instance$getCellMeta.colspan;\n        if (!hidden) {\n          var attrs = [];\n          if (rowspan) {\n            attrs.push(\"rowspan=\\\"\".concat(rowspan, \"\\\"\"));\n          }\n          if (colspan) {\n            attrs.push(\"colspan=\\\"\".concat(colspan, \"\\\"\"));\n          }\n          if (isEmpty(cellData)) {\n            cell = \"<td \".concat(attrs.join(' '), \"></td>\");\n          } else {\n            var value = cellData.toString().replace('<', '&lt;').replace('>', '&gt;').replace(/(<br(\\s*|\\/)>(\\r\\n|\\n)?|\\r\\n|\\n)/g, '<br>\\r\\n').replace(/\\x20/gi, '&nbsp;').replace(/\\t/gi, '&#9;');\n            cell = \"<td \".concat(attrs.join(' '), \">\").concat(value, \"</td>\");\n          }\n        }\n      }\n      CELLS.push(cell);\n    }\n    var TR = ['<tr>'].concat(CELLS, ['</tr>']).join('');\n    if (isColumnHeadersRow) {\n      THEAD.splice(1, 0, TR);\n    } else {\n      TBODY.splice(-1, 0, TR);\n    }\n  }\n  TABLE.splice(1, 0, THEAD.join(''), TBODY.join(''));\n  return TABLE.join('');\n}\n/**\n * Converts 2D array into HTMLTableElement.\n *\n * @param {Array} input Input array which will be converted to HTMLTable\n * @returns {String} outerHTML of the HTMLTableElement\n */\n// eslint-disable-next-line no-restricted-globals\n\nexport function _dataToHTML(input) {\n  var inputLen = input.length;\n  var result = ['<table>'];\n  for (var row = 0; row < inputLen; row += 1) {\n    var rowData = input[row];\n    var columnsLen = rowData.length;\n    var columnsResult = [];\n    if (row === 0) {\n      result.push('<tbody>');\n    }\n    for (var column = 0; column < columnsLen; column += 1) {\n      var cellData = rowData[column];\n      var parsedCellData = isEmpty(cellData) ? '' : cellData.toString().replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/(<br(\\s*|\\/)>(\\r\\n|\\n)?|\\r\\n|\\n)/g, '<br>\\r\\n').replace(/\\x20/gi, '&nbsp;').replace(/\\t/gi, '&#9;');\n      columnsResult.push(\"<td>\".concat(parsedCellData, \"</td>\"));\n    }\n    result.push.apply(result, ['<tr>'].concat(columnsResult, ['</tr>']));\n    if (row + 1 === inputLen) {\n      result.push('</tbody>');\n    }\n  }\n  result.push('</table>');\n  return result.join('');\n}\n/**\n * Converts HTMLTable or string into Handsontable configuration object.\n *\n * @param {Element|String} element Node element which should contain `<table>...</table>`.\n * @param {Document} [rootDocument]\n * @returns {Object} Return configuration object. Contains keys as DefaultSettings.\n */\n// eslint-disable-next-line no-restricted-globals\n\nexport function htmlToGridSettings(element) {\n  var rootDocument = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n  var settingsObj = {};\n  var fragment = rootDocument.createDocumentFragment();\n  var tempElem = rootDocument.createElement('div');\n  fragment.appendChild(tempElem);\n  var checkElement = element;\n  if (typeof checkElement === 'string') {\n    var escapedAdjacentHTML = checkElement.replace(/<td\\b[^>]*?>([\\s\\S]*?)<\\/\\s*td>/g, function (cellFragment) {\n      var openingTag = cellFragment.match(/<td\\b[^>]*?>/g)[0];\n      var cellValue = cellFragment.substring(openingTag.length, cellFragment.lastIndexOf('<')).replace(/(<(?!br)([^>]+)>)/gi, '');\n      var closingTag = '</td>';\n      return \"\".concat(openingTag).concat(cellValue).concat(closingTag);\n    });\n    tempElem.insertAdjacentHTML('afterbegin', \"\".concat(escapedAdjacentHTML));\n    checkElement = tempElem.querySelector('table');\n  }\n  if (!checkElement || !isHTMLTable(checkElement)) {\n    return;\n  }\n  var styleElem = tempElem.querySelector('style');\n  var styleSheet = null;\n  var styleSheetArr = [];\n  if (styleElem) {\n    rootDocument.body.appendChild(styleElem);\n    styleElem.disabled = true;\n    styleSheet = styleElem.sheet;\n    styleSheetArr = styleSheet ? Array.from(styleSheet.cssRules) : [];\n    rootDocument.body.removeChild(styleElem);\n  }\n  var generator = tempElem.querySelector('meta[name$=\"enerator\"]');\n  var hasRowHeaders = checkElement.querySelector('tbody th') !== null;\n  var countCols = Array.from(checkElement.querySelector('tr').cells).reduce(function (cols, cell) {\n    return cols + cell.colSpan;\n  }, 0) - (hasRowHeaders ? 1 : 0);\n  var fixedRowsBottom = checkElement.tFoot && Array.from(checkElement.tFoot.rows) || [];\n  var fixedRowsTop = [];\n  var hasColHeaders = false;\n  var thRowsLen = 0;\n  var countRows = 0;\n  if (checkElement.tHead) {\n    var thRows = Array.from(checkElement.tHead.rows).filter(function (tr) {\n      var isDataRow = tr.querySelector('td') !== null;\n      if (isDataRow) {\n        fixedRowsTop.push(tr);\n      }\n      return !isDataRow;\n    });\n    thRowsLen = thRows.length;\n    hasColHeaders = thRowsLen > 0;\n    if (thRowsLen > 1) {\n      settingsObj.nestedHeaders = Array.from(thRows).reduce(function (rows, row) {\n        var headersRow = Array.from(row.cells).reduce(function (headers, header, currentIndex) {\n          if (hasRowHeaders && currentIndex === 0) {\n            return headers;\n          }\n          var colspan = header.colSpan,\n            innerHTML = header.innerHTML;\n          var nextHeader = colspan > 1 ? {\n            label: innerHTML,\n            colspan: colspan\n          } : innerHTML;\n          headers.push(nextHeader);\n          return headers;\n        }, []);\n        rows.push(headersRow);\n        return rows;\n      }, []);\n    } else if (hasColHeaders) {\n      settingsObj.colHeaders = Array.from(thRows[0].children).reduce(function (headers, header, index) {\n        if (hasRowHeaders && index === 0) {\n          return headers;\n        }\n        headers.push(header.innerHTML);\n        return headers;\n      }, []);\n    }\n  }\n  if (fixedRowsTop.length) {\n    settingsObj.fixedRowsTop = fixedRowsTop.length;\n  }\n  if (fixedRowsBottom.length) {\n    settingsObj.fixedRowsBottom = fixedRowsBottom.length;\n  }\n  var dataRows = [].concat(fixedRowsTop, _toConsumableArray(Array.from(checkElement.tBodies).reduce(function (sections, section) {\n    sections.push.apply(sections, _toConsumableArray(Array.from(section.rows)));\n    return sections;\n  }, [])), _toConsumableArray(fixedRowsBottom));\n  countRows = dataRows.length;\n  var dataArr = new Array(countRows);\n  for (var r = 0; r < countRows; r++) {\n    dataArr[r] = new Array(countCols);\n  }\n  var mergeCells = [];\n  var rowHeaders = [];\n  for (var row = 0; row < countRows; row++) {\n    var tr = dataRows[row];\n    var cells = Array.from(tr.cells);\n    var cellsLen = cells.length;\n    var _loop = function _loop(cellId) {\n      var cell = cells[cellId];\n      var nodeName = cell.nodeName,\n        innerHTML = cell.innerHTML,\n        rowspan = cell.rowSpan,\n        colspan = cell.colSpan;\n      var col = dataArr[row].findIndex(function (value) {\n        return value === void 0;\n      });\n      if (nodeName === 'TD') {\n        if (rowspan > 1 || colspan > 1) {\n          for (var rstart = row; rstart < row + rowspan; rstart++) {\n            if (rstart < countRows) {\n              for (var cstart = col; cstart < col + colspan; cstart++) {\n                dataArr[rstart][cstart] = null;\n              }\n            }\n          }\n          var styleAttr = cell.getAttribute('style');\n          var ignoreMerge = styleAttr && styleAttr.includes('mso-ignore:colspan');\n          if (!ignoreMerge) {\n            mergeCells.push({\n              col: col,\n              row: row,\n              rowspan: rowspan,\n              colspan: colspan\n            });\n          }\n        }\n        var cellStyle = styleSheetArr.reduce(function (settings, cssRule) {\n          if (matchesCSSRules(cell, cssRule)) {\n            var whiteSpace = cssRule.style.whiteSpace;\n            if (whiteSpace) {\n              settings.whiteSpace = whiteSpace;\n            }\n          }\n          return settings;\n        }, {});\n        var cellValue = '';\n        if (cellStyle.whiteSpace === 'nowrap') {\n          cellValue = innerHTML.replace(/[\\r\\n][\\x20]{0,2}/gim, '\\x20').replace(/<br(\\s*|\\/)>/gim, '\\r\\n');\n        } else if (generator && /excel/gi.test(generator.content)) {\n          cellValue = innerHTML.replace(/[\\r\\n][\\x20]{0,2}/g, '\\x20').replace(/<br(\\s*|\\/)>[\\r\\n]?[\\x20]{0,3}/gim, '\\r\\n');\n        } else {\n          cellValue = innerHTML.replace(/<br(\\s*|\\/)>[\\r\\n]?/gim, '\\r\\n');\n        }\n        dataArr[row][col] = cellValue.replace(regEscapedChars, function (match) {\n          return ESCAPED_HTML_CHARS[match];\n        });\n      } else {\n        rowHeaders.push(innerHTML);\n      }\n    };\n    for (var cellId = 0; cellId < cellsLen; cellId++) {\n      _loop(cellId);\n    }\n  }\n  if (mergeCells.length) {\n    settingsObj.mergeCells = mergeCells;\n  }\n  if (rowHeaders.length) {\n    settingsObj.rowHeaders = rowHeaders;\n  }\n  if (dataArr.length) {\n    settingsObj.data = dataArr;\n  }\n  return settingsObj;\n}","map":{"version":3,"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Object","prototype","toString","call","Array","from","isArray","i","arr2","length","matchesCSSRules","isEmpty","ESCAPED_HTML_CHARS","regEscapedChars","RegExp","keys","map","key","concat","join","isHTMLTable","element","nodeName","instanceToHTML","instance","hasColumnHeaders","hasColHeaders","hasRowHeaders","coords","countRows","countCols","data","getData","apply","TABLE","THEAD","TBODY","rowModifier","columnModifier","row","isColumnHeadersRow","CELLS","column","isRowHeadersColumn","cell","getColHeader","getRowHeader","cellData","_instance$getCellMeta","getCellMeta","hidden","rowspan","colspan","attrs","push","value","replace","TR","splice","_dataToHTML","input","inputLen","result","rowData","columnsLen","columnsResult","parsedCellData","htmlToGridSettings","rootDocument","arguments","undefined","document","settingsObj","fragment","createDocumentFragment","tempElem","createElement","appendChild","checkElement","escapedAdjacentHTML","cellFragment","openingTag","match","cellValue","substring","lastIndexOf","closingTag","insertAdjacentHTML","querySelector","styleElem","styleSheet","styleSheetArr","body","disabled","sheet","cssRules","removeChild","generator","cells","reduce","cols","colSpan","fixedRowsBottom","tFoot","rows","fixedRowsTop","thRowsLen","tHead","thRows","filter","tr","isDataRow","nestedHeaders","headersRow","headers","header","currentIndex","innerHTML","nextHeader","label","colHeaders","children","index","dataRows","tBodies","sections","section","dataArr","r","mergeCells","rowHeaders","cellsLen","_loop","cellId","rowSpan","col","findIndex","rstart","cstart","styleAttr","getAttribute","ignoreMerge","includes","cellStyle","settings","cssRule","whiteSpace","style","test","content"],"sources":["C:/Users/mrezy/VSCode/internships-master/node_modules/handsontable/es/utils/parseTable.js"],"sourcesContent":["import \"core-js/modules/es.symbol\";\nimport \"core-js/modules/es.symbol.description\";\nimport \"core-js/modules/es.symbol.iterator\";\nimport \"core-js/modules/es.array.concat\";\nimport \"core-js/modules/es.array.filter\";\nimport \"core-js/modules/es.array.find-index\";\nimport \"core-js/modules/es.array.from\";\nimport \"core-js/modules/es.array.includes\";\nimport \"core-js/modules/es.array.iterator\";\nimport \"core-js/modules/es.array.join\";\nimport \"core-js/modules/es.array.last-index-of\";\nimport \"core-js/modules/es.array.map\";\nimport \"core-js/modules/es.array.reduce\";\nimport \"core-js/modules/es.array.splice\";\nimport \"core-js/modules/es.object.keys\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.regexp.constructor\";\nimport \"core-js/modules/es.regexp.exec\";\nimport \"core-js/modules/es.regexp.to-string\";\nimport \"core-js/modules/es.string.includes\";\nimport \"core-js/modules/es.string.iterator\";\nimport \"core-js/modules/es.string.match\";\nimport \"core-js/modules/es.string.replace\";\nimport \"core-js/modules/web.dom-collections.iterator\";\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nimport { matchesCSSRules } from './../helpers/dom/element';\nimport { isEmpty } from './../helpers/mixed';\nvar ESCAPED_HTML_CHARS = {\n  '&nbsp;': '\\x20',\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>'\n};\nvar regEscapedChars = new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(function (key) {\n  return \"(\".concat(key, \")\");\n}).join('|'), 'gi');\n/**\n * Verifies if node is an HTMLTable element.\n *\n * @param {Node} element Node to verify if it's an HTMLTable.\n * @returns {Boolean}\n */\n\nfunction isHTMLTable(element) {\n  return (element && element.nodeName || '') === 'TABLE';\n}\n/**\n * Converts Handsontable into HTMLTableElement.\n *\n * @param {Core} instance\n * @returns {String} outerHTML of the HTMLTableElement\n */\n\n\nexport function instanceToHTML(instance) {\n  var hasColumnHeaders = instance.hasColHeaders();\n  var hasRowHeaders = instance.hasRowHeaders();\n  var coords = [hasColumnHeaders ? -1 : 0, hasRowHeaders ? -1 : 0, instance.countRows() - 1, instance.countCols() - 1];\n  var data = instance.getData.apply(instance, coords);\n  var countRows = data.length;\n  var countCols = countRows > 0 ? data[0].length : 0;\n  var TABLE = ['<table>', '</table>'];\n  var THEAD = hasColumnHeaders ? ['<thead>', '</thead>'] : [];\n  var TBODY = ['<tbody>', '</tbody>'];\n  var rowModifier = hasRowHeaders ? 1 : 0;\n  var columnModifier = hasColumnHeaders ? 1 : 0;\n\n  for (var row = 0; row < countRows; row += 1) {\n    var isColumnHeadersRow = hasColumnHeaders && row === 0;\n    var CELLS = [];\n\n    for (var column = 0; column < countCols; column += 1) {\n      var isRowHeadersColumn = !isColumnHeadersRow && hasRowHeaders && column === 0;\n      var cell = '';\n\n      if (isColumnHeadersRow) {\n        cell = \"<th>\".concat(instance.getColHeader(column - rowModifier), \"</th>\");\n      } else if (isRowHeadersColumn) {\n        cell = \"<th>\".concat(instance.getRowHeader(row - columnModifier), \"</th>\");\n      } else {\n        var cellData = data[row][column];\n\n        var _instance$getCellMeta = instance.getCellMeta(row - rowModifier, column - columnModifier),\n            hidden = _instance$getCellMeta.hidden,\n            rowspan = _instance$getCellMeta.rowspan,\n            colspan = _instance$getCellMeta.colspan;\n\n        if (!hidden) {\n          var attrs = [];\n\n          if (rowspan) {\n            attrs.push(\"rowspan=\\\"\".concat(rowspan, \"\\\"\"));\n          }\n\n          if (colspan) {\n            attrs.push(\"colspan=\\\"\".concat(colspan, \"\\\"\"));\n          }\n\n          if (isEmpty(cellData)) {\n            cell = \"<td \".concat(attrs.join(' '), \"></td>\");\n          } else {\n            var value = cellData.toString().replace('<', '&lt;').replace('>', '&gt;').replace(/(<br(\\s*|\\/)>(\\r\\n|\\n)?|\\r\\n|\\n)/g, '<br>\\r\\n').replace(/\\x20/gi, '&nbsp;').replace(/\\t/gi, '&#9;');\n            cell = \"<td \".concat(attrs.join(' '), \">\").concat(value, \"</td>\");\n          }\n        }\n      }\n\n      CELLS.push(cell);\n    }\n\n    var TR = ['<tr>'].concat(CELLS, ['</tr>']).join('');\n\n    if (isColumnHeadersRow) {\n      THEAD.splice(1, 0, TR);\n    } else {\n      TBODY.splice(-1, 0, TR);\n    }\n  }\n\n  TABLE.splice(1, 0, THEAD.join(''), TBODY.join(''));\n  return TABLE.join('');\n}\n/**\n * Converts 2D array into HTMLTableElement.\n *\n * @param {Array} input Input array which will be converted to HTMLTable\n * @returns {String} outerHTML of the HTMLTableElement\n */\n// eslint-disable-next-line no-restricted-globals\n\nexport function _dataToHTML(input) {\n  var inputLen = input.length;\n  var result = ['<table>'];\n\n  for (var row = 0; row < inputLen; row += 1) {\n    var rowData = input[row];\n    var columnsLen = rowData.length;\n    var columnsResult = [];\n\n    if (row === 0) {\n      result.push('<tbody>');\n    }\n\n    for (var column = 0; column < columnsLen; column += 1) {\n      var cellData = rowData[column];\n      var parsedCellData = isEmpty(cellData) ? '' : cellData.toString().replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/(<br(\\s*|\\/)>(\\r\\n|\\n)?|\\r\\n|\\n)/g, '<br>\\r\\n').replace(/\\x20/gi, '&nbsp;').replace(/\\t/gi, '&#9;');\n      columnsResult.push(\"<td>\".concat(parsedCellData, \"</td>\"));\n    }\n\n    result.push.apply(result, ['<tr>'].concat(columnsResult, ['</tr>']));\n\n    if (row + 1 === inputLen) {\n      result.push('</tbody>');\n    }\n  }\n\n  result.push('</table>');\n  return result.join('');\n}\n/**\n * Converts HTMLTable or string into Handsontable configuration object.\n *\n * @param {Element|String} element Node element which should contain `<table>...</table>`.\n * @param {Document} [rootDocument]\n * @returns {Object} Return configuration object. Contains keys as DefaultSettings.\n */\n// eslint-disable-next-line no-restricted-globals\n\nexport function htmlToGridSettings(element) {\n  var rootDocument = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n  var settingsObj = {};\n  var fragment = rootDocument.createDocumentFragment();\n  var tempElem = rootDocument.createElement('div');\n  fragment.appendChild(tempElem);\n  var checkElement = element;\n\n  if (typeof checkElement === 'string') {\n    var escapedAdjacentHTML = checkElement.replace(/<td\\b[^>]*?>([\\s\\S]*?)<\\/\\s*td>/g, function (cellFragment) {\n      var openingTag = cellFragment.match(/<td\\b[^>]*?>/g)[0];\n      var cellValue = cellFragment.substring(openingTag.length, cellFragment.lastIndexOf('<')).replace(/(<(?!br)([^>]+)>)/gi, '');\n      var closingTag = '</td>';\n      return \"\".concat(openingTag).concat(cellValue).concat(closingTag);\n    });\n    tempElem.insertAdjacentHTML('afterbegin', \"\".concat(escapedAdjacentHTML));\n    checkElement = tempElem.querySelector('table');\n  }\n\n  if (!checkElement || !isHTMLTable(checkElement)) {\n    return;\n  }\n\n  var styleElem = tempElem.querySelector('style');\n  var styleSheet = null;\n  var styleSheetArr = [];\n\n  if (styleElem) {\n    rootDocument.body.appendChild(styleElem);\n    styleElem.disabled = true;\n    styleSheet = styleElem.sheet;\n    styleSheetArr = styleSheet ? Array.from(styleSheet.cssRules) : [];\n    rootDocument.body.removeChild(styleElem);\n  }\n\n  var generator = tempElem.querySelector('meta[name$=\"enerator\"]');\n  var hasRowHeaders = checkElement.querySelector('tbody th') !== null;\n  var countCols = Array.from(checkElement.querySelector('tr').cells).reduce(function (cols, cell) {\n    return cols + cell.colSpan;\n  }, 0) - (hasRowHeaders ? 1 : 0);\n  var fixedRowsBottom = checkElement.tFoot && Array.from(checkElement.tFoot.rows) || [];\n  var fixedRowsTop = [];\n  var hasColHeaders = false;\n  var thRowsLen = 0;\n  var countRows = 0;\n\n  if (checkElement.tHead) {\n    var thRows = Array.from(checkElement.tHead.rows).filter(function (tr) {\n      var isDataRow = tr.querySelector('td') !== null;\n\n      if (isDataRow) {\n        fixedRowsTop.push(tr);\n      }\n\n      return !isDataRow;\n    });\n    thRowsLen = thRows.length;\n    hasColHeaders = thRowsLen > 0;\n\n    if (thRowsLen > 1) {\n      settingsObj.nestedHeaders = Array.from(thRows).reduce(function (rows, row) {\n        var headersRow = Array.from(row.cells).reduce(function (headers, header, currentIndex) {\n          if (hasRowHeaders && currentIndex === 0) {\n            return headers;\n          }\n\n          var colspan = header.colSpan,\n              innerHTML = header.innerHTML;\n          var nextHeader = colspan > 1 ? {\n            label: innerHTML,\n            colspan: colspan\n          } : innerHTML;\n          headers.push(nextHeader);\n          return headers;\n        }, []);\n        rows.push(headersRow);\n        return rows;\n      }, []);\n    } else if (hasColHeaders) {\n      settingsObj.colHeaders = Array.from(thRows[0].children).reduce(function (headers, header, index) {\n        if (hasRowHeaders && index === 0) {\n          return headers;\n        }\n\n        headers.push(header.innerHTML);\n        return headers;\n      }, []);\n    }\n  }\n\n  if (fixedRowsTop.length) {\n    settingsObj.fixedRowsTop = fixedRowsTop.length;\n  }\n\n  if (fixedRowsBottom.length) {\n    settingsObj.fixedRowsBottom = fixedRowsBottom.length;\n  }\n\n  var dataRows = [].concat(fixedRowsTop, _toConsumableArray(Array.from(checkElement.tBodies).reduce(function (sections, section) {\n    sections.push.apply(sections, _toConsumableArray(Array.from(section.rows)));\n    return sections;\n  }, [])), _toConsumableArray(fixedRowsBottom));\n  countRows = dataRows.length;\n  var dataArr = new Array(countRows);\n\n  for (var r = 0; r < countRows; r++) {\n    dataArr[r] = new Array(countCols);\n  }\n\n  var mergeCells = [];\n  var rowHeaders = [];\n\n  for (var row = 0; row < countRows; row++) {\n    var tr = dataRows[row];\n    var cells = Array.from(tr.cells);\n    var cellsLen = cells.length;\n\n    var _loop = function _loop(cellId) {\n      var cell = cells[cellId];\n      var nodeName = cell.nodeName,\n          innerHTML = cell.innerHTML,\n          rowspan = cell.rowSpan,\n          colspan = cell.colSpan;\n      var col = dataArr[row].findIndex(function (value) {\n        return value === void 0;\n      });\n\n      if (nodeName === 'TD') {\n        if (rowspan > 1 || colspan > 1) {\n          for (var rstart = row; rstart < row + rowspan; rstart++) {\n            if (rstart < countRows) {\n              for (var cstart = col; cstart < col + colspan; cstart++) {\n                dataArr[rstart][cstart] = null;\n              }\n            }\n          }\n\n          var styleAttr = cell.getAttribute('style');\n          var ignoreMerge = styleAttr && styleAttr.includes('mso-ignore:colspan');\n\n          if (!ignoreMerge) {\n            mergeCells.push({\n              col: col,\n              row: row,\n              rowspan: rowspan,\n              colspan: colspan\n            });\n          }\n        }\n\n        var cellStyle = styleSheetArr.reduce(function (settings, cssRule) {\n          if (matchesCSSRules(cell, cssRule)) {\n            var whiteSpace = cssRule.style.whiteSpace;\n\n            if (whiteSpace) {\n              settings.whiteSpace = whiteSpace;\n            }\n          }\n\n          return settings;\n        }, {});\n        var cellValue = '';\n\n        if (cellStyle.whiteSpace === 'nowrap') {\n          cellValue = innerHTML.replace(/[\\r\\n][\\x20]{0,2}/gim, '\\x20').replace(/<br(\\s*|\\/)>/gim, '\\r\\n');\n        } else if (generator && /excel/gi.test(generator.content)) {\n          cellValue = innerHTML.replace(/[\\r\\n][\\x20]{0,2}/g, '\\x20').replace(/<br(\\s*|\\/)>[\\r\\n]?[\\x20]{0,3}/gim, '\\r\\n');\n        } else {\n          cellValue = innerHTML.replace(/<br(\\s*|\\/)>[\\r\\n]?/gim, '\\r\\n');\n        }\n\n        dataArr[row][col] = cellValue.replace(regEscapedChars, function (match) {\n          return ESCAPED_HTML_CHARS[match];\n        });\n      } else {\n        rowHeaders.push(innerHTML);\n      }\n    };\n\n    for (var cellId = 0; cellId < cellsLen; cellId++) {\n      _loop(cellId);\n    }\n  }\n\n  if (mergeCells.length) {\n    settingsObj.mergeCells = mergeCells;\n  }\n\n  if (rowHeaders.length) {\n    settingsObj.rowHeaders = rowHeaders;\n  }\n\n  if (dataArr.length) {\n    settingsObj.data = dataArr;\n  }\n\n  return settingsObj;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}