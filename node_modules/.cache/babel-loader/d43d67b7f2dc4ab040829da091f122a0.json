{"ast":null,"code":"import \"core-js/modules/es.symbol\";\nimport \"core-js/modules/es.symbol.description\";\nimport \"core-js/modules/es.symbol.iterator\";\nimport \"core-js/modules/es.array.filter\";\nimport \"core-js/modules/es.array.find\";\nimport \"core-js/modules/es.array.index-of\";\nimport \"core-js/modules/es.array.iterator\";\nimport \"core-js/modules/es.array.sort\";\nimport \"core-js/modules/es.object.get-own-property-descriptor\";\nimport \"core-js/modules/es.object.get-prototype-of\";\nimport \"core-js/modules/es.object.set-prototype-of\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.reflect.get\";\nimport \"core-js/modules/es.regexp.exec\";\nimport \"core-js/modules/es.string.iterator\";\nimport \"core-js/modules/es.string.replace\";\nimport \"core-js/modules/es.weak-map\";\nimport \"core-js/modules/web.dom-collections.iterator\";\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n      return desc.value;\n    };\n  }\n  return _get(target, property, receiver || target);\n}\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nimport { KEY_CODES, isPrintableChar } from './../helpers/unicode';\nimport { stringify, isDefined } from './../helpers/mixed';\nimport { stripTags } from './../helpers/string';\nimport { pivot, arrayMap } from './../helpers/array';\nimport { addClass, getCaretPosition, getScrollbarWidth, getSelectionEndPosition, outerWidth, outerHeight, offset, getTrimmingContainer, setCaretPosition } from './../helpers/dom/element';\nimport HandsontableEditor from './handsontableEditor';\nvar privatePool = new WeakMap();\n/**\n * @private\n * @editor AutocompleteEditor\n * @class AutocompleteEditor\n * @dependencies HandsontableEditor\n */\n\nvar AutocompleteEditor = /*#__PURE__*/\nfunction (_HandsontableEditor) {\n  _inherits(AutocompleteEditor, _HandsontableEditor);\n  function AutocompleteEditor(instance) {\n    var _this;\n    _classCallCheck(this, AutocompleteEditor);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AutocompleteEditor).call(this, instance));\n    /**\n     * Query string to turn available values over.\n     *\n     * @type {String}\n     */\n\n    _this.query = null;\n    /**\n     * Contains stripped choices.\n     *\n     * @type {String[]}\n     */\n\n    _this.strippedChoices = [];\n    /**\n     * Contains raw choices.\n     *\n     * @type {Array}\n     */\n\n    _this.rawChoices = [];\n    privatePool.set(_assertThisInitialized(_this), {\n      skipOne: false\n    });\n    return _this;\n  }\n  /**\n   * Gets current value from editable element.\n   *\n   * @returns {String}\n   */\n\n  _createClass(AutocompleteEditor, [{\n    key: \"getValue\",\n    value: function getValue() {\n      var _this2 = this;\n      var selectedValue = this.rawChoices.find(function (value) {\n        var strippedValue = _this2.stripValueIfNeeded(value);\n        return strippedValue === _this2.TEXTAREA.value;\n      });\n      if (isDefined(selectedValue)) {\n        return selectedValue;\n      }\n      return this.TEXTAREA.value;\n    }\n    /**\n     * Creates an editor's elements and adds necessary CSS classnames.\n     */\n  }, {\n    key: \"createElements\",\n    value: function createElements() {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"createElements\", this).call(this);\n      addClass(this.htContainer, 'autocompleteEditor');\n      addClass(this.htContainer, this.hot.rootWindow.navigator.platform.indexOf('Mac') === -1 ? '' : 'htMacScroll');\n    }\n    /**\n     * Opens the editor and adjust its size and internal Handsontable's instance.\n     */\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this3 = this;\n      var priv = privatePool.get(this); // this.addHook('beforeKeyDown', event => this.onBeforeKeyDown(event));\n      // Ugly fix for handsontable which grab window object for autocomplete scroll listener instead table element.\n\n      this.TEXTAREA_PARENT.style.overflow = 'auto';\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"open\", this).call(this);\n      this.TEXTAREA_PARENT.style.overflow = '';\n      var choicesListHot = this.htEditor.getInstance();\n      var trimDropdown = this.cellProperties.trimDropdown === void 0 ? true : this.cellProperties.trimDropdown;\n      this.showEditableElement();\n      this.focus();\n      var scrollbarWidth = getScrollbarWidth(this.hot.rootDocument);\n      choicesListHot.updateSettings({\n        colWidths: trimDropdown ? [outerWidth(this.TEXTAREA) - 2] : void 0,\n        width: trimDropdown ? outerWidth(this.TEXTAREA) + scrollbarWidth + 2 : void 0,\n        afterRenderer: function afterRenderer(TD, row, col, prop, value) {\n          var _this3$cellProperties = _this3.cellProperties,\n            filteringCaseSensitive = _this3$cellProperties.filteringCaseSensitive,\n            allowHtml = _this3$cellProperties.allowHtml;\n          var query = _this3.query;\n          var cellValue = stringify(value);\n          var indexOfMatch;\n          var match;\n          if (cellValue && !allowHtml) {\n            indexOfMatch = filteringCaseSensitive === true ? cellValue.indexOf(query) : cellValue.toLowerCase().indexOf(query.toLowerCase());\n            if (indexOfMatch !== -1) {\n              match = cellValue.substr(indexOfMatch, query.length);\n              cellValue = cellValue.replace(match, \"<strong>\".concat(match, \"</strong>\"));\n            }\n          }\n          TD.innerHTML = cellValue;\n        },\n        autoColumnSize: true,\n        modifyColWidth: function modifyColWidth(width, col) {\n          // workaround for <strong> text overlapping the dropdown, not really accurate\n          var autoColumnSize = this.getPlugin('autoColumnSize');\n          var columnWidth = width;\n          if (autoColumnSize) {\n            var autoWidths = autoColumnSize.widths;\n            if (autoWidths[col]) {\n              columnWidth = autoWidths[col];\n            }\n          }\n          return trimDropdown ? columnWidth : columnWidth + 15;\n        }\n      }); // Add additional space for autocomplete holder\n\n      this.htEditor.view.wt.wtTable.holder.parentNode.style['padding-right'] = \"\".concat(scrollbarWidth + 2, \"px\");\n      if (priv.skipOne) {\n        priv.skipOne = false;\n      }\n      this.hot._registerTimeout(function () {\n        _this3.queryChoices(_this3.TEXTAREA.value);\n      });\n    }\n    /**\n     * Closes the editor.\n     */\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.removeHooksByKey('beforeKeyDown');\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"close\", this).call(this);\n    }\n    /**\n     * Verifies result of validation or closes editor if user's cancelled changes. Re-renders WalkOnTable.\n     *\n     * @param {Boolean|undefined} result\n     */\n  }, {\n    key: \"discardEditor\",\n    value: function discardEditor(result) {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"discardEditor\", this).call(this, result);\n      this.hot.view.render();\n    }\n    /**\n     * Prepares choices list based on applied argument.\n     *\n     * @private\n     * @param {String} query\n     */\n  }, {\n    key: \"queryChoices\",\n    value: function queryChoices(query) {\n      var _this4 = this;\n      var source = this.cellProperties.source;\n      this.query = query;\n      if (typeof source === 'function') {\n        source.call(this.cellProperties, query, function (choices) {\n          _this4.rawChoices = choices;\n          _this4.updateChoicesList(_this4.stripValuesIfNeeded(choices));\n        });\n      } else if (Array.isArray(source)) {\n        this.rawChoices = source;\n        this.updateChoicesList(this.stripValuesIfNeeded(source));\n      } else {\n        this.updateChoicesList([]);\n      }\n    }\n    /**\n     * Updates list of the possible completions to choose.\n     *\n     * @private\n     * @param {Array} choicesList\n     */\n  }, {\n    key: \"updateChoicesList\",\n    value: function updateChoicesList(choicesList) {\n      var pos = getCaretPosition(this.TEXTAREA);\n      var endPos = getSelectionEndPosition(this.TEXTAREA);\n      var sortByRelevanceSetting = this.cellProperties.sortByRelevance;\n      var filterSetting = this.cellProperties.filter;\n      var orderByRelevance = null;\n      var highlightIndex = null;\n      var choices = choicesList;\n      if (sortByRelevanceSetting) {\n        orderByRelevance = AutocompleteEditor.sortByRelevance(this.stripValueIfNeeded(this.getValue()), choices, this.cellProperties.filteringCaseSensitive);\n      }\n      var orderByRelevanceLength = Array.isArray(orderByRelevance) ? orderByRelevance.length : 0;\n      if (filterSetting === false) {\n        if (orderByRelevanceLength) {\n          highlightIndex = orderByRelevance[0];\n        }\n      } else {\n        var sorted = [];\n        for (var i = 0, choicesCount = choices.length; i < choicesCount; i++) {\n          if (sortByRelevanceSetting && orderByRelevanceLength <= i) {\n            break;\n          }\n          if (orderByRelevanceLength) {\n            sorted.push(choices[orderByRelevance[i]]);\n          } else {\n            sorted.push(choices[i]);\n          }\n        }\n        highlightIndex = 0;\n        choices = sorted;\n      }\n      this.strippedChoices = choices;\n      this.htEditor.loadData(pivot([choices]));\n      this.updateDropdownHeight();\n      this.flipDropdownIfNeeded();\n      if (this.cellProperties.strict === true) {\n        this.highlightBestMatchingChoice(highlightIndex);\n      }\n      this.hot.listen(false);\n      setCaretPosition(this.TEXTAREA, pos, pos === endPos ? void 0 : endPos);\n    }\n    /**\n     * Checks where is enough place to open editor.\n     *\n     * @private\n     * @returns {Boolean}\n     */\n  }, {\n    key: \"flipDropdownIfNeeded\",\n    value: function flipDropdownIfNeeded() {\n      var textareaOffset = offset(this.TEXTAREA);\n      var textareaHeight = outerHeight(this.TEXTAREA);\n      var dropdownHeight = this.getDropdownHeight();\n      var trimmingContainer = getTrimmingContainer(this.hot.view.wt.wtTable.TABLE);\n      var trimmingContainerScrollTop = trimmingContainer.scrollTop;\n      var headersHeight = outerHeight(this.hot.view.wt.wtTable.THEAD);\n      var containerOffset = {\n        row: 0,\n        col: 0\n      };\n      if (trimmingContainer !== this.hot.rootWindow) {\n        containerOffset = offset(trimmingContainer);\n      }\n      var spaceAbove = textareaOffset.top - containerOffset.top - headersHeight + trimmingContainerScrollTop;\n      var spaceBelow = trimmingContainer.scrollHeight - spaceAbove - headersHeight - textareaHeight;\n      var flipNeeded = dropdownHeight > spaceBelow && spaceAbove > spaceBelow;\n      if (flipNeeded) {\n        this.flipDropdown(dropdownHeight);\n      } else {\n        this.unflipDropdown();\n      }\n      this.limitDropdownIfNeeded(flipNeeded ? spaceAbove : spaceBelow, dropdownHeight);\n      return flipNeeded;\n    }\n    /**\n     * Checks if the internal table should generate scrollbar or could be rendered without it.\n     *\n     * @private\n     * @param {Number} spaceAvailable\n     * @param {Number} dropdownHeight\n     */\n  }, {\n    key: \"limitDropdownIfNeeded\",\n    value: function limitDropdownIfNeeded(spaceAvailable, dropdownHeight) {\n      if (dropdownHeight > spaceAvailable) {\n        var tempHeight = 0;\n        var i = 0;\n        var lastRowHeight = 0;\n        var height = null;\n        do {\n          lastRowHeight = this.htEditor.getRowHeight(i) || this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;\n          tempHeight += lastRowHeight;\n          i += 1;\n        } while (tempHeight < spaceAvailable);\n        height = tempHeight - lastRowHeight;\n        if (this.htEditor.flipped) {\n          this.htEditor.rootElement.style.top = \"\".concat(parseInt(this.htEditor.rootElement.style.top, 10) + dropdownHeight - height, \"px\");\n        }\n        this.setDropdownHeight(tempHeight - lastRowHeight);\n      }\n    }\n    /**\n     * Configures editor to open it at the top.\n     *\n     * @private\n     * @param {Number} dropdownHeight\n     */\n  }, {\n    key: \"flipDropdown\",\n    value: function flipDropdown(dropdownHeight) {\n      var dropdownStyle = this.htEditor.rootElement.style;\n      dropdownStyle.position = 'absolute';\n      dropdownStyle.top = \"\".concat(-dropdownHeight, \"px\");\n      this.htEditor.flipped = true;\n    }\n    /**\n     * Configures editor to open it at the bottom.\n     *\n     * @private\n     */\n  }, {\n    key: \"unflipDropdown\",\n    value: function unflipDropdown() {\n      var dropdownStyle = this.htEditor.rootElement.style;\n      if (dropdownStyle.position === 'absolute') {\n        dropdownStyle.position = '';\n        dropdownStyle.top = '';\n      }\n      this.htEditor.flipped = void 0;\n    }\n    /**\n     * Updates width and height of the internal Handsontable's instance.\n     *\n     * @private\n     */\n  }, {\n    key: \"updateDropdownHeight\",\n    value: function updateDropdownHeight() {\n      var currentDropdownWidth = this.htEditor.getColWidth(0) + getScrollbarWidth(this.hot.rootDocument) + 2;\n      var trimDropdown = this.cellProperties.trimDropdown;\n      this.htEditor.updateSettings({\n        height: this.getDropdownHeight(),\n        width: trimDropdown ? void 0 : currentDropdownWidth\n      });\n      this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer();\n    }\n    /**\n     * Sets new height of the internal Handsontable's instance.\n     *\n     * @private\n     * @param {Number} height\n     */\n  }, {\n    key: \"setDropdownHeight\",\n    value: function setDropdownHeight(height) {\n      this.htEditor.updateSettings({\n        height: height\n      });\n    }\n    /**\n     * Creates new selection on specified row index, or deselects selected cells.\n     *\n     * @private\n     * @param {Number|undefined} index\n     */\n  }, {\n    key: \"highlightBestMatchingChoice\",\n    value: function highlightBestMatchingChoice(index) {\n      if (typeof index === 'number') {\n        this.htEditor.selectCell(index, 0, void 0, void 0, void 0, false);\n      } else {\n        this.htEditor.deselectCell();\n      }\n    }\n    /**\n     * Calculates and return the internal Handsontable's height.\n     *\n     * @private\n     * @returns {Number}\n     */\n  }, {\n    key: \"getDropdownHeight\",\n    value: function getDropdownHeight() {\n      var firstRowHeight = this.htEditor.getInstance().getRowHeight(0) || 23;\n      var visibleRows = this.cellProperties.visibleRows;\n      return this.strippedChoices.length >= visibleRows ? visibleRows * firstRowHeight : this.strippedChoices.length * firstRowHeight + 8;\n    }\n    /**\n     * Sanitizes value from potential dangerous tags.\n     *\n     * @private\n     * @param {String} value\n     * @returns {String}\n     */\n  }, {\n    key: \"stripValueIfNeeded\",\n    value: function stripValueIfNeeded(value) {\n      return this.stripValuesIfNeeded([value])[0];\n    }\n    /**\n     * Sanitizes an array of the values from potential dangerous tags.\n     *\n     * @private\n     * @param {String[]} values\n     * @returns {String[]}\n     */\n  }, {\n    key: \"stripValuesIfNeeded\",\n    value: function stripValuesIfNeeded(values) {\n      var allowHtml = this.cellProperties.allowHtml;\n      var stringifiedValues = arrayMap(values, function (value) {\n        return stringify(value);\n      });\n      var strippedValues = arrayMap(stringifiedValues, function (value) {\n        return allowHtml ? value : stripTags(value);\n      });\n      return strippedValues;\n    }\n    /**\n     * Captures use of arrow down and up to control their behaviour.\n     *\n     * @private\n     * @param {Number} keyCode\n     * @returns {Boolean}\n     */\n  }, {\n    key: \"allowKeyEventPropagation\",\n    value: function allowKeyEventPropagation(keyCode) {\n      var selectedRange = this.htEditor.getSelectedRangeLast();\n      var selected = {\n        row: selectedRange ? selectedRange.from.row : -1\n      };\n      var allowed = false;\n      if (keyCode === KEY_CODES.ARROW_DOWN && selected.row > 0 && selected.row < this.htEditor.countRows() - 1) {\n        allowed = true;\n      }\n      if (keyCode === KEY_CODES.ARROW_UP && selected.row > -1) {\n        allowed = true;\n      }\n      return allowed;\n    }\n    /**\n     * onBeforeKeyDown callback.\n     *\n     * @private\n     * @param {KeyboardEvent} event\n     */\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      var _this5 = this;\n      var priv = privatePool.get(this);\n      priv.skipOne = false;\n      if (isPrintableChar(event.keyCode) || event.keyCode === KEY_CODES.BACKSPACE || event.keyCode === KEY_CODES.DELETE || event.keyCode === KEY_CODES.INSERT) {\n        var timeOffset = 0; // on ctl+c / cmd+c don't update suggestion list\n\n        if (event.keyCode === KEY_CODES.C && (event.ctrlKey || event.metaKey)) {\n          return;\n        }\n        if (!this.isOpened()) {\n          timeOffset += 10;\n        }\n        if (this.htEditor) {\n          this.hot._registerTimeout(function () {\n            _this5.queryChoices(_this5.TEXTAREA.value);\n            priv.skipOne = true;\n          }, timeOffset);\n        }\n      }\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"onBeforeKeyDown\", this).call(this, event);\n    }\n  }]);\n  return AutocompleteEditor;\n}(HandsontableEditor);\n/**\n * Filters and sorts by relevance.\n *\n * @param value\n * @param choices\n * @param caseSensitive\n * @returns {Number[]} array of indexes in original choices array\n */\n\nAutocompleteEditor.sortByRelevance = function (value, choices, caseSensitive) {\n  var choicesRelevance = [];\n  var currentItem;\n  var valueLength = value.length;\n  var valueIndex;\n  var charsLeft;\n  var result = [];\n  var i;\n  var choicesCount = choices.length;\n  if (valueLength === 0) {\n    for (i = 0; i < choicesCount; i++) {\n      result.push(i);\n    }\n    return result;\n  }\n  for (i = 0; i < choicesCount; i++) {\n    currentItem = stripTags(stringify(choices[i]));\n    if (caseSensitive) {\n      valueIndex = currentItem.indexOf(value);\n    } else {\n      valueIndex = currentItem.toLowerCase().indexOf(value.toLowerCase());\n    }\n    if (valueIndex !== -1) {\n      charsLeft = currentItem.length - valueIndex - valueLength;\n      choicesRelevance.push({\n        baseIndex: i,\n        index: valueIndex,\n        charsLeft: charsLeft,\n        value: currentItem\n      });\n    }\n  }\n  choicesRelevance.sort(function (a, b) {\n    if (b.index === -1) {\n      return -1;\n    }\n    if (a.index === -1) {\n      return 1;\n    }\n    if (a.index < b.index) {\n      return -1;\n    } else if (b.index < a.index) {\n      return 1;\n    } else if (a.index === b.index) {\n      if (a.charsLeft < b.charsLeft) {\n        return -1;\n      } else if (a.charsLeft > b.charsLeft) {\n        return 1;\n      }\n    }\n    return 0;\n  });\n  for (i = 0, choicesCount = choicesRelevance.length; i < choicesCount; i++) {\n    result.push(choicesRelevance[i].baseIndex);\n  }\n  return result;\n};\nexport default AutocompleteEditor;","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","value","object","hasOwnProperty","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","create","_setPrototypeOf","p","KEY_CODES","isPrintableChar","stringify","isDefined","stripTags","pivot","arrayMap","addClass","getCaretPosition","getScrollbarWidth","getSelectionEndPosition","outerWidth","outerHeight","offset","getTrimmingContainer","setCaretPosition","HandsontableEditor","privatePool","WeakMap","AutocompleteEditor","_HandsontableEditor","_this","query","strippedChoices","rawChoices","set","skipOne","getValue","_this2","selectedValue","find","strippedValue","stripValueIfNeeded","TEXTAREA","createElements","htContainer","hot","rootWindow","navigator","platform","indexOf","open","_this3","priv","TEXTAREA_PARENT","style","overflow","choicesListHot","htEditor","getInstance","trimDropdown","cellProperties","showEditableElement","focus","scrollbarWidth","rootDocument","updateSettings","colWidths","width","afterRenderer","TD","row","col","prop","_this3$cellProperties","filteringCaseSensitive","allowHtml","cellValue","indexOfMatch","match","toLowerCase","substr","replace","concat","innerHTML","autoColumnSize","modifyColWidth","getPlugin","columnWidth","autoWidths","widths","view","wt","wtTable","holder","parentNode","_registerTimeout","queryChoices","close","removeHooksByKey","discardEditor","result","render","_this4","source","choices","updateChoicesList","stripValuesIfNeeded","Array","isArray","choicesList","pos","endPos","sortByRelevanceSetting","sortByRelevance","filterSetting","filter","orderByRelevance","highlightIndex","orderByRelevanceLength","sorted","choicesCount","push","loadData","updateDropdownHeight","flipDropdownIfNeeded","strict","highlightBestMatchingChoice","listen","textareaOffset","textareaHeight","dropdownHeight","getDropdownHeight","trimmingContainer","TABLE","trimmingContainerScrollTop","scrollTop","headersHeight","THEAD","containerOffset","spaceAbove","top","spaceBelow","scrollHeight","flipNeeded","flipDropdown","unflipDropdown","limitDropdownIfNeeded","spaceAvailable","tempHeight","lastRowHeight","height","getRowHeight","wtSettings","settings","defaultRowHeight","flipped","rootElement","parseInt","setDropdownHeight","dropdownStyle","position","currentDropdownWidth","getColWidth","alignOverlaysWithTrimmingContainer","index","selectCell","deselectCell","firstRowHeight","visibleRows","values","stringifiedValues","strippedValues","allowKeyEventPropagation","keyCode","selectedRange","getSelectedRangeLast","selected","from","allowed","ARROW_DOWN","countRows","ARROW_UP","onBeforeKeyDown","event","_this5","BACKSPACE","DELETE","INSERT","timeOffset","C","ctrlKey","metaKey","isOpened","caseSensitive","choicesRelevance","currentItem","valueLength","valueIndex","charsLeft","baseIndex","sort","a","b"],"sources":["C:/Users/mrezy/VSCode/internships-master/node_modules/handsontable/es/editors/autocompleteEditor.js"],"sourcesContent":["import \"core-js/modules/es.symbol\";\nimport \"core-js/modules/es.symbol.description\";\nimport \"core-js/modules/es.symbol.iterator\";\nimport \"core-js/modules/es.array.filter\";\nimport \"core-js/modules/es.array.find\";\nimport \"core-js/modules/es.array.index-of\";\nimport \"core-js/modules/es.array.iterator\";\nimport \"core-js/modules/es.array.sort\";\nimport \"core-js/modules/es.object.get-own-property-descriptor\";\nimport \"core-js/modules/es.object.get-prototype-of\";\nimport \"core-js/modules/es.object.set-prototype-of\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.reflect.get\";\nimport \"core-js/modules/es.regexp.exec\";\nimport \"core-js/modules/es.string.iterator\";\nimport \"core-js/modules/es.string.replace\";\nimport \"core-js/modules/es.weak-map\";\nimport \"core-js/modules/web.dom-collections.iterator\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport { KEY_CODES, isPrintableChar } from './../helpers/unicode';\nimport { stringify, isDefined } from './../helpers/mixed';\nimport { stripTags } from './../helpers/string';\nimport { pivot, arrayMap } from './../helpers/array';\nimport { addClass, getCaretPosition, getScrollbarWidth, getSelectionEndPosition, outerWidth, outerHeight, offset, getTrimmingContainer, setCaretPosition } from './../helpers/dom/element';\nimport HandsontableEditor from './handsontableEditor';\nvar privatePool = new WeakMap();\n/**\n * @private\n * @editor AutocompleteEditor\n * @class AutocompleteEditor\n * @dependencies HandsontableEditor\n */\n\nvar AutocompleteEditor =\n/*#__PURE__*/\nfunction (_HandsontableEditor) {\n  _inherits(AutocompleteEditor, _HandsontableEditor);\n\n  function AutocompleteEditor(instance) {\n    var _this;\n\n    _classCallCheck(this, AutocompleteEditor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AutocompleteEditor).call(this, instance));\n    /**\n     * Query string to turn available values over.\n     *\n     * @type {String}\n     */\n\n    _this.query = null;\n    /**\n     * Contains stripped choices.\n     *\n     * @type {String[]}\n     */\n\n    _this.strippedChoices = [];\n    /**\n     * Contains raw choices.\n     *\n     * @type {Array}\n     */\n\n    _this.rawChoices = [];\n    privatePool.set(_assertThisInitialized(_this), {\n      skipOne: false\n    });\n    return _this;\n  }\n  /**\n   * Gets current value from editable element.\n   *\n   * @returns {String}\n   */\n\n\n  _createClass(AutocompleteEditor, [{\n    key: \"getValue\",\n    value: function getValue() {\n      var _this2 = this;\n\n      var selectedValue = this.rawChoices.find(function (value) {\n        var strippedValue = _this2.stripValueIfNeeded(value);\n\n        return strippedValue === _this2.TEXTAREA.value;\n      });\n\n      if (isDefined(selectedValue)) {\n        return selectedValue;\n      }\n\n      return this.TEXTAREA.value;\n    }\n    /**\n     * Creates an editor's elements and adds necessary CSS classnames.\n     */\n\n  }, {\n    key: \"createElements\",\n    value: function createElements() {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"createElements\", this).call(this);\n\n      addClass(this.htContainer, 'autocompleteEditor');\n      addClass(this.htContainer, this.hot.rootWindow.navigator.platform.indexOf('Mac') === -1 ? '' : 'htMacScroll');\n    }\n    /**\n     * Opens the editor and adjust its size and internal Handsontable's instance.\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this3 = this;\n\n      var priv = privatePool.get(this); // this.addHook('beforeKeyDown', event => this.onBeforeKeyDown(event));\n      // Ugly fix for handsontable which grab window object for autocomplete scroll listener instead table element.\n\n      this.TEXTAREA_PARENT.style.overflow = 'auto';\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"open\", this).call(this);\n\n      this.TEXTAREA_PARENT.style.overflow = '';\n      var choicesListHot = this.htEditor.getInstance();\n      var trimDropdown = this.cellProperties.trimDropdown === void 0 ? true : this.cellProperties.trimDropdown;\n      this.showEditableElement();\n      this.focus();\n      var scrollbarWidth = getScrollbarWidth(this.hot.rootDocument);\n      choicesListHot.updateSettings({\n        colWidths: trimDropdown ? [outerWidth(this.TEXTAREA) - 2] : void 0,\n        width: trimDropdown ? outerWidth(this.TEXTAREA) + scrollbarWidth + 2 : void 0,\n        afterRenderer: function afterRenderer(TD, row, col, prop, value) {\n          var _this3$cellProperties = _this3.cellProperties,\n              filteringCaseSensitive = _this3$cellProperties.filteringCaseSensitive,\n              allowHtml = _this3$cellProperties.allowHtml;\n          var query = _this3.query;\n          var cellValue = stringify(value);\n          var indexOfMatch;\n          var match;\n\n          if (cellValue && !allowHtml) {\n            indexOfMatch = filteringCaseSensitive === true ? cellValue.indexOf(query) : cellValue.toLowerCase().indexOf(query.toLowerCase());\n\n            if (indexOfMatch !== -1) {\n              match = cellValue.substr(indexOfMatch, query.length);\n              cellValue = cellValue.replace(match, \"<strong>\".concat(match, \"</strong>\"));\n            }\n          }\n\n          TD.innerHTML = cellValue;\n        },\n        autoColumnSize: true,\n        modifyColWidth: function modifyColWidth(width, col) {\n          // workaround for <strong> text overlapping the dropdown, not really accurate\n          var autoColumnSize = this.getPlugin('autoColumnSize');\n          var columnWidth = width;\n\n          if (autoColumnSize) {\n            var autoWidths = autoColumnSize.widths;\n\n            if (autoWidths[col]) {\n              columnWidth = autoWidths[col];\n            }\n          }\n\n          return trimDropdown ? columnWidth : columnWidth + 15;\n        }\n      }); // Add additional space for autocomplete holder\n\n      this.htEditor.view.wt.wtTable.holder.parentNode.style['padding-right'] = \"\".concat(scrollbarWidth + 2, \"px\");\n\n      if (priv.skipOne) {\n        priv.skipOne = false;\n      }\n\n      this.hot._registerTimeout(function () {\n        _this3.queryChoices(_this3.TEXTAREA.value);\n      });\n    }\n    /**\n     * Closes the editor.\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.removeHooksByKey('beforeKeyDown');\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"close\", this).call(this);\n    }\n    /**\n     * Verifies result of validation or closes editor if user's cancelled changes. Re-renders WalkOnTable.\n     *\n     * @param {Boolean|undefined} result\n     */\n\n  }, {\n    key: \"discardEditor\",\n    value: function discardEditor(result) {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"discardEditor\", this).call(this, result);\n\n      this.hot.view.render();\n    }\n    /**\n     * Prepares choices list based on applied argument.\n     *\n     * @private\n     * @param {String} query\n     */\n\n  }, {\n    key: \"queryChoices\",\n    value: function queryChoices(query) {\n      var _this4 = this;\n\n      var source = this.cellProperties.source;\n      this.query = query;\n\n      if (typeof source === 'function') {\n        source.call(this.cellProperties, query, function (choices) {\n          _this4.rawChoices = choices;\n\n          _this4.updateChoicesList(_this4.stripValuesIfNeeded(choices));\n        });\n      } else if (Array.isArray(source)) {\n        this.rawChoices = source;\n        this.updateChoicesList(this.stripValuesIfNeeded(source));\n      } else {\n        this.updateChoicesList([]);\n      }\n    }\n    /**\n     * Updates list of the possible completions to choose.\n     *\n     * @private\n     * @param {Array} choicesList\n     */\n\n  }, {\n    key: \"updateChoicesList\",\n    value: function updateChoicesList(choicesList) {\n      var pos = getCaretPosition(this.TEXTAREA);\n      var endPos = getSelectionEndPosition(this.TEXTAREA);\n      var sortByRelevanceSetting = this.cellProperties.sortByRelevance;\n      var filterSetting = this.cellProperties.filter;\n      var orderByRelevance = null;\n      var highlightIndex = null;\n      var choices = choicesList;\n\n      if (sortByRelevanceSetting) {\n        orderByRelevance = AutocompleteEditor.sortByRelevance(this.stripValueIfNeeded(this.getValue()), choices, this.cellProperties.filteringCaseSensitive);\n      }\n\n      var orderByRelevanceLength = Array.isArray(orderByRelevance) ? orderByRelevance.length : 0;\n\n      if (filterSetting === false) {\n        if (orderByRelevanceLength) {\n          highlightIndex = orderByRelevance[0];\n        }\n      } else {\n        var sorted = [];\n\n        for (var i = 0, choicesCount = choices.length; i < choicesCount; i++) {\n          if (sortByRelevanceSetting && orderByRelevanceLength <= i) {\n            break;\n          }\n\n          if (orderByRelevanceLength) {\n            sorted.push(choices[orderByRelevance[i]]);\n          } else {\n            sorted.push(choices[i]);\n          }\n        }\n\n        highlightIndex = 0;\n        choices = sorted;\n      }\n\n      this.strippedChoices = choices;\n      this.htEditor.loadData(pivot([choices]));\n      this.updateDropdownHeight();\n      this.flipDropdownIfNeeded();\n\n      if (this.cellProperties.strict === true) {\n        this.highlightBestMatchingChoice(highlightIndex);\n      }\n\n      this.hot.listen(false);\n      setCaretPosition(this.TEXTAREA, pos, pos === endPos ? void 0 : endPos);\n    }\n    /**\n     * Checks where is enough place to open editor.\n     *\n     * @private\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"flipDropdownIfNeeded\",\n    value: function flipDropdownIfNeeded() {\n      var textareaOffset = offset(this.TEXTAREA);\n      var textareaHeight = outerHeight(this.TEXTAREA);\n      var dropdownHeight = this.getDropdownHeight();\n      var trimmingContainer = getTrimmingContainer(this.hot.view.wt.wtTable.TABLE);\n      var trimmingContainerScrollTop = trimmingContainer.scrollTop;\n      var headersHeight = outerHeight(this.hot.view.wt.wtTable.THEAD);\n      var containerOffset = {\n        row: 0,\n        col: 0\n      };\n\n      if (trimmingContainer !== this.hot.rootWindow) {\n        containerOffset = offset(trimmingContainer);\n      }\n\n      var spaceAbove = textareaOffset.top - containerOffset.top - headersHeight + trimmingContainerScrollTop;\n      var spaceBelow = trimmingContainer.scrollHeight - spaceAbove - headersHeight - textareaHeight;\n      var flipNeeded = dropdownHeight > spaceBelow && spaceAbove > spaceBelow;\n\n      if (flipNeeded) {\n        this.flipDropdown(dropdownHeight);\n      } else {\n        this.unflipDropdown();\n      }\n\n      this.limitDropdownIfNeeded(flipNeeded ? spaceAbove : spaceBelow, dropdownHeight);\n      return flipNeeded;\n    }\n    /**\n     * Checks if the internal table should generate scrollbar or could be rendered without it.\n     *\n     * @private\n     * @param {Number} spaceAvailable\n     * @param {Number} dropdownHeight\n     */\n\n  }, {\n    key: \"limitDropdownIfNeeded\",\n    value: function limitDropdownIfNeeded(spaceAvailable, dropdownHeight) {\n      if (dropdownHeight > spaceAvailable) {\n        var tempHeight = 0;\n        var i = 0;\n        var lastRowHeight = 0;\n        var height = null;\n\n        do {\n          lastRowHeight = this.htEditor.getRowHeight(i) || this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;\n          tempHeight += lastRowHeight;\n          i += 1;\n        } while (tempHeight < spaceAvailable);\n\n        height = tempHeight - lastRowHeight;\n\n        if (this.htEditor.flipped) {\n          this.htEditor.rootElement.style.top = \"\".concat(parseInt(this.htEditor.rootElement.style.top, 10) + dropdownHeight - height, \"px\");\n        }\n\n        this.setDropdownHeight(tempHeight - lastRowHeight);\n      }\n    }\n    /**\n     * Configures editor to open it at the top.\n     *\n     * @private\n     * @param {Number} dropdownHeight\n     */\n\n  }, {\n    key: \"flipDropdown\",\n    value: function flipDropdown(dropdownHeight) {\n      var dropdownStyle = this.htEditor.rootElement.style;\n      dropdownStyle.position = 'absolute';\n      dropdownStyle.top = \"\".concat(-dropdownHeight, \"px\");\n      this.htEditor.flipped = true;\n    }\n    /**\n     * Configures editor to open it at the bottom.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"unflipDropdown\",\n    value: function unflipDropdown() {\n      var dropdownStyle = this.htEditor.rootElement.style;\n\n      if (dropdownStyle.position === 'absolute') {\n        dropdownStyle.position = '';\n        dropdownStyle.top = '';\n      }\n\n      this.htEditor.flipped = void 0;\n    }\n    /**\n     * Updates width and height of the internal Handsontable's instance.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"updateDropdownHeight\",\n    value: function updateDropdownHeight() {\n      var currentDropdownWidth = this.htEditor.getColWidth(0) + getScrollbarWidth(this.hot.rootDocument) + 2;\n      var trimDropdown = this.cellProperties.trimDropdown;\n      this.htEditor.updateSettings({\n        height: this.getDropdownHeight(),\n        width: trimDropdown ? void 0 : currentDropdownWidth\n      });\n      this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer();\n    }\n    /**\n     * Sets new height of the internal Handsontable's instance.\n     *\n     * @private\n     * @param {Number} height\n     */\n\n  }, {\n    key: \"setDropdownHeight\",\n    value: function setDropdownHeight(height) {\n      this.htEditor.updateSettings({\n        height: height\n      });\n    }\n    /**\n     * Creates new selection on specified row index, or deselects selected cells.\n     *\n     * @private\n     * @param {Number|undefined} index\n     */\n\n  }, {\n    key: \"highlightBestMatchingChoice\",\n    value: function highlightBestMatchingChoice(index) {\n      if (typeof index === 'number') {\n        this.htEditor.selectCell(index, 0, void 0, void 0, void 0, false);\n      } else {\n        this.htEditor.deselectCell();\n      }\n    }\n    /**\n     * Calculates and return the internal Handsontable's height.\n     *\n     * @private\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"getDropdownHeight\",\n    value: function getDropdownHeight() {\n      var firstRowHeight = this.htEditor.getInstance().getRowHeight(0) || 23;\n      var visibleRows = this.cellProperties.visibleRows;\n      return this.strippedChoices.length >= visibleRows ? visibleRows * firstRowHeight : this.strippedChoices.length * firstRowHeight + 8;\n    }\n    /**\n     * Sanitizes value from potential dangerous tags.\n     *\n     * @private\n     * @param {String} value\n     * @returns {String}\n     */\n\n  }, {\n    key: \"stripValueIfNeeded\",\n    value: function stripValueIfNeeded(value) {\n      return this.stripValuesIfNeeded([value])[0];\n    }\n    /**\n     * Sanitizes an array of the values from potential dangerous tags.\n     *\n     * @private\n     * @param {String[]} values\n     * @returns {String[]}\n     */\n\n  }, {\n    key: \"stripValuesIfNeeded\",\n    value: function stripValuesIfNeeded(values) {\n      var allowHtml = this.cellProperties.allowHtml;\n      var stringifiedValues = arrayMap(values, function (value) {\n        return stringify(value);\n      });\n      var strippedValues = arrayMap(stringifiedValues, function (value) {\n        return allowHtml ? value : stripTags(value);\n      });\n      return strippedValues;\n    }\n    /**\n     * Captures use of arrow down and up to control their behaviour.\n     *\n     * @private\n     * @param {Number} keyCode\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"allowKeyEventPropagation\",\n    value: function allowKeyEventPropagation(keyCode) {\n      var selectedRange = this.htEditor.getSelectedRangeLast();\n      var selected = {\n        row: selectedRange ? selectedRange.from.row : -1\n      };\n      var allowed = false;\n\n      if (keyCode === KEY_CODES.ARROW_DOWN && selected.row > 0 && selected.row < this.htEditor.countRows() - 1) {\n        allowed = true;\n      }\n\n      if (keyCode === KEY_CODES.ARROW_UP && selected.row > -1) {\n        allowed = true;\n      }\n\n      return allowed;\n    }\n    /**\n     * onBeforeKeyDown callback.\n     *\n     * @private\n     * @param {KeyboardEvent} event\n     */\n\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      var _this5 = this;\n\n      var priv = privatePool.get(this);\n      priv.skipOne = false;\n\n      if (isPrintableChar(event.keyCode) || event.keyCode === KEY_CODES.BACKSPACE || event.keyCode === KEY_CODES.DELETE || event.keyCode === KEY_CODES.INSERT) {\n        var timeOffset = 0; // on ctl+c / cmd+c don't update suggestion list\n\n        if (event.keyCode === KEY_CODES.C && (event.ctrlKey || event.metaKey)) {\n          return;\n        }\n\n        if (!this.isOpened()) {\n          timeOffset += 10;\n        }\n\n        if (this.htEditor) {\n          this.hot._registerTimeout(function () {\n            _this5.queryChoices(_this5.TEXTAREA.value);\n\n            priv.skipOne = true;\n          }, timeOffset);\n        }\n      }\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"onBeforeKeyDown\", this).call(this, event);\n    }\n  }]);\n\n  return AutocompleteEditor;\n}(HandsontableEditor);\n/**\n * Filters and sorts by relevance.\n *\n * @param value\n * @param choices\n * @param caseSensitive\n * @returns {Number[]} array of indexes in original choices array\n */\n\n\nAutocompleteEditor.sortByRelevance = function (value, choices, caseSensitive) {\n  var choicesRelevance = [];\n  var currentItem;\n  var valueLength = value.length;\n  var valueIndex;\n  var charsLeft;\n  var result = [];\n  var i;\n  var choicesCount = choices.length;\n\n  if (valueLength === 0) {\n    for (i = 0; i < choicesCount; i++) {\n      result.push(i);\n    }\n\n    return result;\n  }\n\n  for (i = 0; i < choicesCount; i++) {\n    currentItem = stripTags(stringify(choices[i]));\n\n    if (caseSensitive) {\n      valueIndex = currentItem.indexOf(value);\n    } else {\n      valueIndex = currentItem.toLowerCase().indexOf(value.toLowerCase());\n    }\n\n    if (valueIndex !== -1) {\n      charsLeft = currentItem.length - valueIndex - valueLength;\n      choicesRelevance.push({\n        baseIndex: i,\n        index: valueIndex,\n        charsLeft: charsLeft,\n        value: currentItem\n      });\n    }\n  }\n\n  choicesRelevance.sort(function (a, b) {\n    if (b.index === -1) {\n      return -1;\n    }\n\n    if (a.index === -1) {\n      return 1;\n    }\n\n    if (a.index < b.index) {\n      return -1;\n    } else if (b.index < a.index) {\n      return 1;\n    } else if (a.index === b.index) {\n      if (a.charsLeft < b.charsLeft) {\n        return -1;\n      } else if (a.charsLeft > b.charsLeft) {\n        return 1;\n      }\n    }\n\n    return 0;\n  });\n\n  for (i = 0, choicesCount = choicesRelevance.length; i < choicesCount; i++) {\n    result.push(choicesRelevance[i].baseIndex);\n  }\n\n  return result;\n};\n\nexport default AutocompleteEditor;"],"mappings":"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"},"metadata":{},"sourceType":"module"}